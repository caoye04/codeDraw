<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>有氧能力：第五大生命体征</title>
    <!-- 添加必要的库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
        }
        .slide {
            background: white;
            margin-bottom: 20px;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            min-height: 500px;
            position: relative;
            overflow: hidden;
        }
        .slide.active {
            display: block;
        }
        h1 {
            color: #1a365d;
            font-size: 2.5em;
            margin-bottom: 30px;
            line-height: 1.2;
        }
        h2 {
            color: #2c5282;
            font-size: 2em;
            margin-bottom: 25px;
        }
        h3 {
            color: #2b6cb0;
            font-size: 1.3em;
            margin: 15px 0;
        }
        p {
            color: #2d3748;
            font-size: 1.2em;
            line-height: 1.6;
            margin: 15px 0;
        }
        .controls {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        button {
            background: #2b6cb0;
            color: white;
            border: none;
            padding: 12px 25px;
            margin: 0 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        button:hover {
            background: #2c5282;
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        .progress {
            background: #e2e8f0;
            height: 5px;
            margin-top: 20px;
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-bar {
            background: #2b6cb0;
            height: 100%;
            width: 0%;
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        .list-item {
            margin: 15px 0;
            display: flex;
            align-items: center;
            font-size: 1.1em;
            color: #2d3748;
        }
        .list-item:before {
            content: "•";
            color: #2b6cb0;
            font-size: 1.5em;
            margin-right: 10px;
            font-weight: bold;
        }
        .download-btn {
            background: #38a169;
            margin-top: 20px;
        }
        .download-btn:hover {
            background: #2f855a;
        }
        .toc-item {
            padding: 12px 20px;
            margin: 10px 0;
            background: #f8fafc;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #2d3748;
            font-size: 1.1em;
        }
        .toc-item:hover {
            background: #ebf4ff;
            transform: translateX(10px);
            color: #2b6cb0;
        }
        .highlight-box {
            background: #ebf8ff;
            padding: 20px;
            border-left: 4px solid #2b6cb0;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
            color: #2d3748;
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        .grid-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .grid-item:hover {
            background: #ebf4ff;
            transform: translateY(-2px);
        }
        .download-progress {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            display: none;
            text-align: center;
            z-index: 1000;
            min-width: 300px;
        }
        .download-progress p {
            margin: 10px 0;
            color: #2d3748;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2b6cb0;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    <div class="download-progress" id="downloadProgress">
        <div class="loading-spinner"></div>
        <p>正在生成PPT，请稍候...</p>
        <p id="progressText">0/8 页面</p>
    </div>

    <div class="container">
        <!-- 幻灯片内容与之前相同，保持不变 -->
        <!-- 第1页 - 封面 -->
        <div class="slide active" id="slide1">
            <h1>有氧能力：第五大生命体征</h1>
            <p style="font-size: 1.3em; color: #4a5568; margin-bottom: 40px;">
                探索医学领域的革新性突破
            </p>
            <div class="highlight-box">
                汇报人：曹烨<br>
                日期：2025年5月6日
            </div>
        </div>

        <!-- 第2页 - 目录 -->
        <div class="slide" id="slide2">
            <h2>目录</h2>
            <div class="toc-item">1. 生命体征概述</div>
            <div class="toc-item">2. 有氧能力的定义与重要性</div>
            <div class="toc-item">3. 研究历程与科学依据</div>
            <div class="toc-item">4. 临床应用价值</div>
            <div class="toc-item">5. 测量方法与标准</div>
            <div class="toc-item">6. 总结与未来展望</div>
        </div>

        <!-- 第3页 - 生命体征概述 -->
        <div class="slide" id="slide3">
            <h2>1. 生命体征概述</h2>
            <div class="highlight-box">
                生命体征是反映人体基本生理功能的各项指标
            </div>
            <div class="grid-container">
                <div class="grid-item">
                    <h3>传统四大生命体征</h3>
                    <div class="list-item">体温（36.3~37.2℃）</div>
                    <div class="list-item">血压（120/80mmHg）</div>
                    <div class="list-item">呼吸（16-20次/分）</div>
                    <div class="list-item">脉搏（60-100次/分）</div>
                </div>
                <div class="grid-item">
                    <h3>临床意义</h3>
                    <div class="list-item">反映生命状态</div>
                    <div class="list-item">判断健康状况</div>
                    <div class="list-item">指导临床决策</div>
                    <div class="list-item">评估预后情况</div>
                </div>
            </div>
        </div>

        <!-- 第4页 - 有氧能力的定义与重要性 -->
        <div class="slide" id="slide4">
            <h2>2. 有氧能力的定义与重要性</h2>
            <div class="highlight-box">
                最大摄氧量（VO2max）：人体在单位时间内摄取和利用氧气的最大能力
            </div>
            <div class="list-item">衡量心肺功能的黄金标准</div>
            <div class="list-item">反映机体整体代谢能力</div>
            <div class="list-item">预测全因死亡率的独立因素</div>
            <div class="list-item">与多种慢性疾病发病风险密切相关</div>
            <p style="margin-top: 30px;">重要性：</p>
            <div class="grid-container">
                <div class="grid-item">
                    <div class="list-item">预测寿命</div>
                    <div class="list-item">评估健康状态</div>
                </div>
                <div class="grid-item">
                    <div class="list-item">指导运动处方</div>
                    <div class="list-item">监测康复进展</div>
                </div>
            </div>
        </div>

        <!-- 第5页 - 研究历程 -->
        <div class="slide" id="slide5">
            <h2>3. 研究历程与科学依据</h2>
            <div class="highlight-box">
                从发现到确立的漫长历程
            </div>
            <div class="list-item">1960s：首次提出有氧能力与健康关系的研究</div>
            <div class="list-item">1980s：建立标准化测量方法和评估体系</div>
            <div class="list-item">1990s：大规模流行病学研究验证其预测价值</div>
            <div class="list-item">2000s：多中心研究证实其独立预测作用</div>
            <div class="list-item">2016：美国心脏协会正式提议将其列为第五大生命体征</div>
            <div class="list-item">2020s：全球范围内逐步推广应用</div>
        </div>

        <!-- 第6页 - 临床应用 -->
        <div class="slide" id="slide6">
            <h2>4. 临床应用价值</h2>
            <div class="grid-container">
                <div class="grid-item">
                    <h3>疾病预防</h3>
                    <div class="list-item">心血管疾病风险评估</div>
                    <div class="list-item">代谢综合征筛查</div>
                    <div class="list-item">老年功能退化预警</div>
                </div>
                <div class="grid-item">
                    <h3>治疗指导</h3>
                    <div class="list-item">手术风险评估</div>
                    <div class="list-item">康复进展监测</div>
                    <div class="list-item">运动处方制定</div>
                </div>
            </div>
            <div class="highlight-box">
                案例：术前评估中的应用显著降低了手术并发症风险
            </div>
        </div>

        <!-- 第7页 - 测量方法 -->
        <div class="slide" id="slide7">
            <h2>5. 测量方法与标准</h2>
            <div class="grid-container">
                <div class="grid-item">
                    <h3>直接测量</h3>
                    <div class="list-item">运动心肺功能测试</div>
                    <div class="list-item">气体代谢分析</div>
                    <div class="list-item">最大负荷测试</div>
                </div>
                <div class="grid-item">
                    <h3>间接评估</h3>
                    <div class="list-item">6分钟步行测试</div>
                    <div class="list-item">台阶测试</div>
                    <div class="list-item">问卷评估</div>
                </div>
            </div>
            <div class="highlight-box">
                标准值因年龄、性别、运动水平等因素而异，需个性化解释
            </div>
        </div>

        <!-- 第8页 - 总结 -->
        <div class="slide" id="slide8">
            <h2>6. 总结与未来展望</h2>
            <div class="highlight-box">
                有氧能力作为第五大生命体征的地位日益巩固
            </div>
            <p>主要结论：</p>
            <div class="list-item">具有独特的预测价值和临床意义</div>
            <div class="list-item">测量方法日益完善和标准化</div>
            <div class="list-item">临床应用范围不断扩大</div>
            <p>未来展望：</p>
            <div class="list-item">可穿戴设备实时监测技术的发展</div>
            <div class="list-item">人工智能辅助评估系统的应用</div>
            <div class="list-item">个性化运动处方的精准制定</div>
        </div>

        <div class="controls">
            <button onclick="previousSlide()">上一页</button>
            <button onclick="nextSlide()">下一页</button>
            <button class="download-btn" onclick="downloadPPT()">下载PPT</button>
        </div>
        <div class="progress">
            <div class="progress-bar" id="progress"></div>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        const totalSlides = 8;

        function updateSlide() {
            document.querySelectorAll('.slide').forEach(slide => {
                slide.classList.remove('active');
            });
            document.getElementById(`slide${currentSlide}`).classList.add('active');
            
            const progress = (currentSlide - 1) / (totalSlides - 1) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
        }

        function nextSlide() {
            if (currentSlide < totalSlides) {
                currentSlide++;
                updateSlide();
            }
        }

        function previousSlide() {
            if (currentSlide > 1) {
                currentSlide--;
                updateSlide();
            }
        }

        async function downloadPPT() {
            try {
                // 显示遮罩和进度提示
                document.getElementById('overlay').style.display = 'block';
                document.getElementById('downloadProgress').style.display = 'block';

                // 创建PPT对象
                const pptx = new PptxGenJS();

                // 获取所有幻灯片
                const slides = document.querySelectorAll('.slide');
                let currentProgress = 0;

                // 设置PPT页面大小（16:9）
                pptx.layout = 'LAYOUT_16x9';

                // 遍历每个幻灯片
                for (let i = 0; i < slides.length; i++) {
                    const slide = slides[i];
                    
                    // 确保幻灯片可见
                    slide.style.display = 'block';
                    
                    // 更新进度
                    document.getElementById('progressText').textContent = `${i + 1}/${slides.length} 页面`;

                    // 将幻灯片转换为canvas
                    const canvas = await html2canvas(slide, {
                        scale: 2, // 提高清晰度
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });

                    // 将canvas转换为图片数据
                    const imageData = canvas.toDataURL('image/png');

                    // 添加到PPT
                    const pptSlide = pptx.addSlide();
                    pptSlide.addImage({
                        data: imageData,
                        x: 0,
                        y: 0,
                        w: '100%',
                        h: '100%'
                    });

                    // 恢复幻灯片显示状态
                    slide.style.display = 'none';
                    if (i === currentSlide - 1) {
                        slide.style.display = 'block';
                    }
                }

                // 保存PPT文件
                await pptx.writeFile('有氧能力-第五大生命体征.pptx');

                // 隐藏进度提示和遮罩
                document.getElementById('downloadProgress').style.display = 'none';
                document.getElementById('overlay').style.display = 'none';

            } catch (error) {
                console.error('生成PPT时出错:', error);
                alert('生成PPT时出现错误，请重试');
                document.getElementById('downloadProgress').style.display = 'none';
                document.getElementById('overlay').style.display = 'none';
            }
        }

        // 键盘控制
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                nextSlide();
            } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                previousSlide();
            }
        });
    </script>
</body>
</html>